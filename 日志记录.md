1. glm直接使用target_include_directoris链接头文件即可，无需进行库的链接

2. 包含main.cpp与Transfrom.cpp时出现link2005错误，原因见：<https://blog.csdn.net/wanzew/article/details/81638128>
        报错报的也是dot和cross两个函数(直接定义在头文件中的)：

   解决方案——直接将这两个函数设置为inline内联，这样不会重复编译；其他的函数则在必要时在cpp文件中实现，  头文件只放声明与内联函数

3. glm库中的矩阵实现是列主序（看后续有没有办法可以改掉），使用矩阵时要么列主序要么设置完成后transpose一下

4. 初始化智能指针的方法：std::make_shared\<Class_Name>(Parameter_List)

5. 判断是否与平行四边形相交：使用games101课上讲的方法（叉积判断），注意比较浮点数是否相同时给个范围（看Geometry.h那里的方法），因为会有精度损失问题

6. 使用DirectIntegrator_SampleBSDF来绘制球时，球上的颜色并不会出现期望中的有噪点的样子，而是直接出现色块，初步推断为对球上的BSDF采样一条光线时出现问题，而平行四边形正常：

<img src="日志记录.assets/球.png" alt="球" style="zoom: 50%;" />

<img src="日志记录.assets/四边形.png" alt="四边形" style="zoom:50%;" />

经过测量：球上灰色部分为权重（0.5）* 光源强度（1.0f），深蓝为0.5*背景色，黑色部分为.0f，对应积分器中最后的部分，即深蓝为击中背景（未被阻挡），黑色为被阻挡但阻挡物不发光（地板），即球上每次采样要么全都采样中光源，要么全都不采样到光源。再思考为什么

更改sampling中的代码后，球上得到了噪点，但是仍然有明显的分界线，而且整体变暗：

<img src="日志记录.assets/更改采样.png" alt="更改采样" style="zoom:50%;" />

暂时认为是SampleBSDF特有的问题，**后续再进行解决**    **记得！  ps: 解决，如下**

—— 使用了第8条同样的做法，得到同一个交点采样的三个入射方向在虽然数值不同，但是归一化后都是同一个方向，说明bsdf采样的方法有问题，重新思考：

<img src="日志记录.assets/image-20231015153901189.png" alt="image-20231015153901189" style="zoom:50%;" />

<img src="日志记录.assets/image-20231015153914482.png" alt="image-20231015153914482" style="zoom:50%;" />

问题出在toWorld函数，检查后：

<img src="日志记录.assets/image-20231015154615414.png" alt="image-20231015154615414" style="zoom: 50%;" />

问题所在：tangent和bitangent计算有误，全是0，接着找：问题出在sphere的求交中最后求好tangent和bitangent时没有赋给intersection（呃呃，解决，最终结果：

<img src="日志记录.assets/image-20231015160057278.png" alt="image-20231015160057278" style="zoom:50%;" />



7. debug做法：找到大概可能的区域，直接用print来确定具体范围，从而找到出错的具体位置

解决没有光源时产生segmentation fault的问题



8. SampleLight记录：一开始时出现了如下的问题：

   <img src="日志记录.assets/光源自遮挡.png" alt="光源自遮挡" style="zoom: 33%;" />

可以看到面光源自己会产生一定的阴影，而当加入球体后：

<img src="日志记录.assets/光源自遮挡1.png" alt="光源自遮挡1" style="zoom: 67%;" />

会产生这种问题，当将光源远离该位置时，球体可以正常显示：

<img src="日志记录.assets/光源自遮挡2.png" alt="光源自遮挡2" style="zoom:67%;" />

在注释掉R方项后，确定不是衰减项的问题（因为猜测和距离有关），随后开始print（**这里的经验：在图像结果与自己预期不符合时，通过qq截图来获取大概位置，然后手动发射一条光线，接着在integrator中追踪，不断print，调用debugPrint函数来打印各项信息，最终确定bug位置**），得到问题根源：glm库的length函数有问题（**glm中向量的length是返回向量元素的个数**），修改后：

<img src="日志记录.assets/image-20231015162403628.png" alt="image-20231015162403628" style="zoom:50%;" />

debug过程大概如下，**这样的话也解决了之前Moer-lite中平行四边形与球的算法无法使用的问题**：

<img src="日志记录.assets/image-20231014192012199.png" alt="image-20231014192012199" style="zoom:50%;" />

<img src="日志记录.assets/image-20231014192144323.png" alt="image-20231014192144323" style="zoom:50%;" />

修改后的sampleLight直接积分器还是可能会出现segmentation fault，再看是什么问题

—— 问题出在这里，使用clamp函数有可能会出现segmentation fault（查找过程：感觉使用这个函数的时候可能还是有问题，然后直接选用第一个光源，不使用这个函数，生成4次后都没有segmentation fault，然后确认问题在这里面，将clamp函数更改后，也不会出现问题）

<img src="日志记录.assets/image-20231015211019026.png" alt="image-20231015211019026" style="zoom:50%;" />

原因：Clamp函数是通过返回值来得到clamp后i的值的，不能直接传入就完事，要重新赋值给i（呃呃



9. 头文件问题：出现未定义基类以及无法识别标识符等等问题时，可能是头文件的include产生了循环包含的问题：解决头文件问题即可。

   **后续思考：项目的头文件使用的具体规范是什么**

   

10. 写WhittedInterator时，出现生成到一半卡住的情况，思考为什么

<img src="日志记录.assets/image-20231017204236929.png" alt="image-20231017204236929" style="zoom: 33%;" />

如上图，**在main函数将spp改为1后，在integrator出不停的cerr来查找出错的地方**，得到上述结果——可以看到不停1212循环，因此应该是出现了镜面再到镜面，一直循环的情况，目前限制循环上限次数，解决问题，在设置spp为1，超出上限后返回红色值，得到如下结果：

<img src="日志记录.assets/image-20231017210329264.png" alt="image-20231017210329264" style="zoom:50%;" />

可以看到球的边缘有一处红色，试验几次法线问题似乎就是出现在边缘上，思考为什么



11. Cube算法中最后先计算tExit，再计算tEnter的地方暂时不知道为什么，用debug的方法去看下，下面是注释掉和未注释的区别（上为注释，下为未注释）

    <img src="日志记录.assets/image-20231019151342725.png" alt="image-20231019151342725" style="zoom:50%;" />

    <img src="日志记录.assets/image-20231019151451168.png" alt="image-20231019151451168" style="zoom:50%;" />

在经过打印过程后发现是如下图所示的原因：

<img src="日志记录.assets/image-20231019160131937.png" alt="image-20231019160131937" style="zoom:50%;" />

**思考：如果是像这种的，通过进入和离开来判断是否相交的，直接都先与离开判断，再与进入判断，从而杜绝从内部发射光线认为没有交点的问题**



12. PathIntegrator刚实现出来长下面这样：

    <img src="日志记录.assets/image-20231019205401059.png" alt="image-20231019205401059" style="zoom:50%;" />

上图是在进行背景颜色和权重的不停调整后得到的结果，由于会亮很多，因此需要开始考虑**hdr图片**的输出，且注意上图中有一个问题：左边的光源的左边像是被挡住了一样，这是由于目前的算法在采样shadowRay时，哪怕是被另一个光源挡住了，也会认为被阻挡，从而对spectrum没有任何贡献，暂时粗略改进下算法：在被新的光源阻挡时，重新在该光源上采样，且认为新的采样点不会被阻挡（还是有问题，但应该会好点），下面是前后效果对比（上为前，下为后，可以看到有明显改善）：

<img src="日志记录.assets/image-20231020111704766.png" alt="image-20231020111704766" style="zoom:33%;" />

<img src="日志记录.assets/image-20231020111837721.png" alt="image-20231020111837721" style="zoom:33%;" />
